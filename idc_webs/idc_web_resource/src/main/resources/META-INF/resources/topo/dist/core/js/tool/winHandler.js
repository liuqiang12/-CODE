define(["window/toolbar","window/nodeAttribute","window/linkAttribute","window/containerAttribute","window/toolWindow","window/global","element/Node","element/Link","tool/util","JTopo"],function(e,n,t,i,o,c,r,a,l){function d(o,r,a){if(s)return!0;f(),s=e.init(r),p=n.initImageNode(r),m=n.initTextNode(r),w=t.initLink(r),h=t.initLine(r),k=i.init(r),g=c.initExProp(r),F=c.initAutoLayout(r),C=c.initAlarmConfig(r);var l=a||{};u(o,r,l),s.modeBtns.click(function(){var e=$(this).find("input").val();r.setMode(e)}),F.cancelBtn.click(function(){s.edit_autoLayout.click()}),p.okBtn.click(function(){"create"==p.win.mode&&s.edit_createImage.click()}),p.cancelBtn.click(function(){"create"==p.win.mode?s.edit_createImage.click():p.win.trigger("resetWindow")}),m.okBtn.click(function(){"create"==m.win.mode&&s.edit_createText.click()}),m.cancelBtn.click(function(){"create"==m.win.mode?s.edit_createText.click():m.win.trigger("resetWindow")}),h.cancelBtn.click(function(){s.edit_createLine.click()}),C.cancelBtn.click(function(){s.edit_alarm_config.click()}),C.okBtn.click(function(){s.edit_alarm_config.click()})}function u(e,n,t){var i=n.prop.config;if(s){t&&$.each(t,function(e,n){n?s[e].show():s[e].hide()}),s.returnBtn.click(function(){n.goBack()});var c=0,r=0;s.fullScreen.click(function(e){if(window!=top){var n=$(window.parent.document.getElementById(i.frameId));if(!i.frameId)throw new Error("can't launch fullScreen need config frameId");if(s.fullScreen._isClick){if(c=n.width(),r=n.height(),!c||!r)throw new Error("can't launch fullScreen frameId not exist");n.width($(window.parent).width()),n.height($(window.parent).height()),l.launchFullScreen(window.parent.document.documentElement)}else c&&r&&(n.width(c),n.height(r),c=r=0),l.exitFullScreen(window.parent.document)}else s.fullScreen._isClick?l.launchFullScreen(document.documentElement):l.exitFullScreen(document)}),s.centerBtn.click(function(){e.centerAndZoom()}),s.commonBtn.click(function(){n.scaleX=1,n.scaleY=1}),s.exportImg.click(function(){var n=e.canvas.toDataURL("image/png"),t=window.open("about:blank","image from canvas");t.document.write("<img src='"+n+"' alt='from canvas'/>")}),s.zoomOut.click(function(){e.zoomOut()}),s.zoomIn.click(function(){e.zoomIn()}),s.zoomCheck.click(function(){s.zoomCheck._isClick?e.wheelZoom||(e.wheelZoom=.85):e.wheelZoom=null}),s.printBtn.click(function(){window.print()}),s.eagleEye.click(function(){e.eagleEye.visible=s.eagleEye._isClick}),s.addSearchMode([{name:"名称",value:"name",search:function(e){return{results:n.findNode("name="+e.trim()),event:function(e){l.nodeAsCenter(n,e)}}},deepSearch:function(e){return{url:"http://202.102.36.137:9004/newui/liposs/plattopo/topo/platTopo!findDev.action?areaId=1&type=2&s="+e.trim(),filter:function(e){var n=[];return e&&(console.info(e),e=e.replace(/'/g,'"'),e=$.parseJSON(e),$.each(e,function(e,t){n.push({id:t.id,pid:t.pid,prop:{name:t.name,content:t.ip+" | "+t.model+" | "}})})),n},event:function(e){n.goDown(e.pid,function(){l.nodeAsCenter(n,n.findNode("id="+e.id)[0])})}}}},{name:"ID",value:"id",search:function(e){return{results:n.findNode("id="+e.trim()),event:function(e){l.nodeAsCenter(n,e)}}},deepSearch:function(e){return{url:"http://202.102.36.137:9004/newui/liposs/plattopo/topo/platTopo!findDev.action?areaId=1&type=4&s="+e.trim(),filter:function(e){var n=[];return e&&(e=e.replace(/'/g,'"'),console.info(e),e=$.parseJSON(e),$.each(e,function(e,t){n.push({id:t.id,pid:t.pid,prop:{name:t.name,content:t.ip+" | "+t.model+" | "}})})),n},event:function(e){n.goDown(e.pid,function(){l.nodeAsCenter(n,n.findNode("id="+e.id)[0])})}}}},{name:"IP",value:"ip",deepSearch:function(e){return{url:"http://202.102.36.137:9004/newui/liposs/plattopo/topo/platTopo!findDev.action?areaId=1&type=1&s="+e.trim(),filter:function(e){var n=[];return e&&(e=e.replace(/'/g,'"'),console.info(e),e=$.parseJSON(e),$.each(e,function(e,t){n.push({id:t.id,pid:t.pid,prop:{name:t.name,content:t.ip+" | "+t.model+" | "}})})),n},event:function(e){n.goDown(e.pid,function(){l.nodeAsCenter(n,n.findNode("id="+e.id)[0])})}}}},{name:"基本属性",value:"prop",search:function(e){return{results:n.findNode(e.trim()),event:function(e){l.nodeAsCenter(n,e)}}}},{name:"业务属性",value:"exprop",search:function(e){return{results:n.findNode(e.trim(),!0),event:function(e){l.nodeAsCenter(n,e)}}}}]),s.searchBtn.click(function(){s.doSearch()}),s.edit_autoLayout.click(function(){s.edit_autoLayout._isClick?F.win.show():F.win.trigger("resetWindow")}),s.edit_createImage.click(function(){s.edit_createImage._isClick?(p.head.find("span:first").text("创建节点"),p.win.show(),p.win.mode="create"):p.win.trigger("resetWindow")}),s.edit_createText.click(function(){s.edit_createText._isClick?(m.head.find("span:first").text("创建文本"),m.win.show(),m.win.mode="create"):m.win.trigger("resetWindow")}),s.edit_createLink.click(function(){s.edit_createLink._isClick?(n.initLinkEditMode(s.edit_createLink),n.setMode("linkEdit"),o.alert({title:"链路编辑模式",content:"<h3>使用说明:</h3><h4>首次左键选中节点作为链路起点，次选节点为终点，连续两次选中不同节点则建立链接。</h4><h3>Error:</h3><h4>暂不支持对分组,分组的缩放节点,分组成员之间创建链接!</h4>"})):n.setMode("edit")}),s.edit_createLine.click(function(){s.edit_createLine._isClick?(n.setMode("linkEdit"),h.win.trigger("drawLine")):(h.win.trigger("resetWindow"),n.setMode("edit"))}),s.edit_save.click(function(){o.confirm({title:"保存拓扑",content:"<h4>确定保存当前拓扑数据?</h4>",handler:function(e){e?n.saveTopo():console.info("cancel save")}})}),s.edit_alarm_config.click(function(){s.edit_alarm_config._isClick?C.win.show():C.win.trigger("resetWindow")})}}function f(){"use strict";var e=[["#000000","#424242","#636363","#9C9C94","#CEC6CE","#EFEFEF","#F7F7F7","#FFFFFF"],["#FF0000","#FF9C00","#FFFF00","#00FF00","#00FFFF","#0000FF","#9C00FF","#FF00FF"],["#F7C6CE","#FFE7CE","#FFEFC6","#D6EFD6","#CEDEE7","#CEE7F7","#D6D6E7","#E7D6DE"],["#E79C9C","#FFC69C","#FFE79C","#B5D6A5","#A5C6CE","#9CC6EF","#B5A5D6","#D6A5BD"],["#E76363","#F7AD6B","#FFD663","#94BD7B","#73A5AD","#6BADDE","#8C7BC6","#C67BA5"],["#CE0000","#E79439","#EFC631","#6BA54A","#4A7B8C","#3984C6","#634AA5","#A54A7B"],["#9C0000","#B56308","#BD9400","#397B21","#104A5A","#085294","#311873","#731842"],["#630000","#7B3900","#846300","#295218","#083139","#003163","#21104A","#4A1031"]],n=function(e,n){e.addClass("bootstrap-colorpalette");var t=[];$.each(n,function(e,n){t.push("<div>"),$.each(n,function(e,n){var i=['<button type="button" class="btn-color" style="background-color:',n,'" data-value="',n,'" title="',n,'"></button>'].join("");t.push(i)}),t.push("</div>")}),e.html(t.join(""))},t=function(e){e.element.on("click",function(n){var t=$(n.target),i=t.closest(".btn-color");if(i[0]){var o=i.attr("data-value");e.value=o,e.element.trigger({type:"selectColor",color:o,element:e.element})}})},i=function(i,o){this.element=i,n(i,o&&o.colors||e),t(this)};$.fn.extend({colorPalette:function(e){return this.each(function(){var n=$(this),t=n.data("colorpalette");t||n.data("colorpalette",new i(n,e))}),this}})}var s,p,m,w,h,k,g,F,C;return{init:d,getTools:function(){return o},setMode:function(e){s.setMode(e)},getToolBar:function(){return s},editImage:function(e){p.edit(e)},editText:function(e){m.edit(e)},editLink:function(e){w.edit(e)},editExprop:function(e){g.edit(e)},createContainer:function(e){k.create(e)},editContainer:function(e){k.edit(e)}}});
//# sourceMappingURL=winHandler.js.map