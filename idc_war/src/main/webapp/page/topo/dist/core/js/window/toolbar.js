define(["text!template/toolbar.html","window/toolWindow","tool/util","window/base","element/Link"],function(e,t,n,o,i){var a=$(e);return{init:function(e){function n(e,t){var n="<option value='"+t.value+"'>"+t.name+"</option>";e.append(n),e.item.push(t)}function i(e){$.each(e,function(e,t){n(C,t)})}function l(){C.item=[],C.html(""),n(C,{name:"请选择结果",value:"default"})}var c=a.find("div[name=topo_toolbar]"),d=a.find("div[name=topo_toolbar_child]").hide();$("body").append(a);var r=c.find("button[name=return]"),u=c.find("label[name=topo_mode]"),f=c.find("button[name=full_screen]"),h=c.find("button[name=center]"),m=c.find("button[name=common]"),s=c.find("button[name=zoom_checkbox]"),p=c.find("button[name=zoom_in]"),g=c.find("button[name=zoom_out]"),v=c.find("button[name=export_image]"),_=c.find("button[name=print]"),b=c.find("button[name=eagle_eye]"),w=c.find("select[name=search_mode]"),y=c.find("input[name=search_text]"),k=c.find("button[name=search]"),C=c.find("select[name=search_result]").hide(),x=d.find("button[name=auto_layout]"),z=d.find("button[name=create_image]"),B=d.find("button[name=create_text]"),S=d.find("button[name=create_link]"),I=d.find("button[name=create_line]"),L=d.find("button[name=edit_save]"),M=d.find("button[name=draw_alarm]"),O="glyphicon-remove-sign",T=c.find("label[name='topo_mode'][title='编辑']");return c.find("[data-toggle*='tooltip']").tooltip(),d.find("[data-toggle*='tooltip']").tooltip(),$(window).resize(function(){var e=T.offset().left+17-d.width()/2,t=c.offset().top+c.height()+2;d.css({left:e,top:t})}),u.click(function(){if(u.mode=$(this).find("input").val(),"edit"==u.mode){var e=T.offset().left+17-d.width()/2,t=c.offset().top+c.height()+2;d.css({left:e,top:t}),d.show()}else d.hide()}),o.toggleClick(f,"glyphicon-fullscreen",O),o.toggleClick(s,"glyphicon-resize-small",O),o.toggleClick(b,"glyphicon-eye-open","glyphicon-eye-close"),y.keydown(function(e){13==e.keyCode&&k.click()}),o.toggleClick(x,"glyphicon-th",O),o.toggleClick(z,"glyphicon-picture",O),o.toggleClick(B,"glyphicon-font",O),o.toggleClick(I,"glyphicon-pencil",O),o.toggleClick(S,"glyphicon-sort",O),o.toggleClick(M,"glyphicon-warning-sign",O),w.item=[],w.change(function(){var e=this;$.each(w.item,function(t,n){if(n.value==e.value)return w.mode=n,!1})}),C.change(function(){var e=this;"default"!=e.value&&$.each(C.item,function(t,n){if(n.value==e.value)return n.event(),C.hide(),!1})}),{hide:function(){c.hide(),d.hide()},show:function(){c.show(),"edit"==u.mode&&d.show()},setMode:function(e){u.find("input[value="+e+"]").click()},addSearchMode:function(e){e instanceof Array?$.each(e,function(e,t){n(w,t)}):n(w,e)},doSearch:function(){var e=y.val().trim();if(""==e)return void t.alert({content:"<h4>输入不能为空！</h4>",width:300});l();var n={},o=[],a=w.mode||w.item[0];a.search&&(n=a.search(e)),n.results&&n.results.length>0?($.each(n.results,function(e,t){o.push({name:t.prop.name+" | "+(t.prop.content||"")+"(该图层)",value:o.length,event:function(){n.event(t)}})}),i(o),C.show()):a.deepSearch?(n=a.deepSearch(e),$.ajax({url:n.url,type:"POST",success:function(e){$.each(n.filter(e),function(e,t){o.push({name:t.prop.name+" | "+(t.prop.content||""),value:o.length,event:function(){n.event(t)}})}),o.length>0?(i(o),C.show()):t.alert({content:"<h3> 无查询结果！</h3>",width:300})},error:function(e){t.alert({content:"<h3>查询失败!若未登陆请登录后再试！</h3>",width:300})}})):t.alert({content:"<h3> 无查询结果！</h3>",width:300})},fatherBar:c,edit_childBar:d,returnBtn:r,modeBtns:u,fullScreen:f,centerBtn:h,commonBtn:m,zoomIn:p,zoomOut:g,zoomCheck:s,exportImg:v,printBtn:_,eagleEye:b,searchInput:y,searchBtn:k,edit_autoLayout:x,edit_createImage:z,edit_createText:B,edit_createLink:S,edit_createLine:I,edit_save:L,edit_alarm_config:M}}}});
//# sourceMappingURL=toolbar.js.map