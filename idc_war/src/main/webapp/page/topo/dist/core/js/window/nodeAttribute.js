define(["text!template/nodeAttribute.html","window/base","element/Node","tool/util"],function(e,n,t,i){var a=$(e),o=a.find("[name=topo_image_node]").hide(),d=a.find("[name=topo_text_node]").hide();return $("body").append(a),{initImageNode:function(e){function d(e){"node"==e.elementType&&(r.find("span:first").text("编辑节点"),o.target=e,o.mode="edit",u.val(e.prop.name),p.val(e.prop.id),x.val(e.prop.textPosition),h.attr("src",e.prop.image),o.show())}var l=a.find("[name=image_select]"),c=l.find("[name=topo_node_selected_image]");o.css(n.defaultPosition);var r=o.find("[name=head]"),s=o.find("[name=cancel]"),m=o.find("[name=ok]"),f=o.find("[name=find_image]"),p=o.find("[name=id]"),g=o.find("[name=id_check]"),v=o.find("[name=id_group]"),u=o.find("[name=name]"),_=o.find("[name=name_group]"),h=o.find("[name=image]"),k=o.find("[name=image_group]"),x=o.find("[name=position]"),b=o.find("[name=position_group]"),w=[v,_,k,b],P=[p,u,h,x];n.resetHide(P,w),n.moveable(r,o),o.find(".close").click(function(){s.click()}),g.click(function(e){p.attr("disabled",!this.checked)}),p.attr("disabled",!0);var C=!0;f.click(function(t){if(C){var i=e.prop.config.image||{};$.each(i,function(e,t){var i=$("<div class='panel panel-default'><div class='panel-heading' role='tab'><h4 class='panel-title'><a data-toggle='collapse' data-parent='[name=topo_node_selected_image]' href='[name=topo_node_selected_image_"+e+"]'  aria-controls='collapseOne'>"+e+"</a></h4></div><div name='topo_node_selected_image_"+e+"' class='panel-collapse collapse' role='tabpanel' ><div class='panel-body'><div class='container'><div class='row'><div name='image_show' class='btn-group col-md-6' data-toggle='buttons'></div></div></div></div></div></div>");c.append(i),$.each(t,function(e,t){n.makeImageBtn(i.find("[name=image_show]"),t)})}),C=!1}c.find(".panel:first").find("a").click(),l.modal("toggle")}),l.on("hidden.bs.modal",function(e){c.find("[name=image_show]").find(".active").removeClass("active"),c.find(".in").collapse("hide")});var y=h.attr("src");return o.on("resetWindow",function(e){e&&$.isFunction(e)&&e(),p.val(""),p.attr("disabled",!0),g.attr("checked",!1),u.val(""),x.val("Bottom_Center"),h.attr("src",y),o.hide(),o.css(n.defaultPosition)}),l.find("[name=ok]").click(function(){h.attr("src",l.find(".in").find(".active img").attr("src")),l.modal("toggle")}),m.click(function(){var n=u.val().trim(),a=p.val(),d=h.attr("src"),l=x.val();if("create"==o.mode&&e.addElement(t.createNode({name:n,id:a,pid:e.prop.pid||e.prop.id,image:d,textPosition:l,x:i.getCenterPosition(e).x,y:i.getCenterPosition(e).y})),"edit"==o.mode){var c=o.target;c.prop.name=n,c.prop.id=a,c.setNodeImage(d),c.setTextPosition(l),o.trigger("resetWindow")}}),{win:o,head:r,okBtn:m,cancelBtn:s,id:p,idCheck:g,name:u,image:h,position:x,edit:d}},initTextNode:function(e){function a(e){"TextNode"==e.elementType&&(o.find("span:first").text("编辑文本"),d.target=e,d.mode="edit",m.val(d.target.text),s.val(d.target.prop.fontColor),r.val(parseInt(d.target.prop.fontSize)),d.show())}d.css(n.defaultPosition);var o=d.find("[name=head]"),l=d.find("[name=cancel]"),c=d.find("[name=ok]"),r=d.find("[name=size_num]"),s=d.find("[name=color]"),m=d.find("[name=text]"),f=d.find("[name-text_group]"),p=d.find("[name=size_group]"),g=d.find("[name=color_group]"),v=[r,s,m],u=[p,g,f];return d.find(".close").click(function(){l.click()}),n.resetHide(v,u),n.moveable(o,d),n.colorSelect(s,d.find("[name=color_palette]")),n.resizeNum(p,{bottom:2}),d.on("resetWindow",function(e){e&&$.isFunction(e)&&e(),m.val(""),s.val(""),r.val(12),d.hide(),d.css(n.defaultPosition)}),c.click(function(){if("create"==d.mode&&e.addElement(t.createTextNode({text:m.val().trim(),fontSize:r.val(),fontColor:s.val(),x:i.getCenterPosition(e).x,y:i.getCenterPosition(e).y})),"edit"==d.mode){var n=d.target;n.text=m.val(),n.setFontColor(s.val()),n.setFont(r.val()),d.trigger("resetWindow")}}),{win:d,head:o,okBtn:c,cancelBtn:l,size:r,color:s,text:m,edit:a}}}});
//# sourceMappingURL=nodeAttribute.js.map