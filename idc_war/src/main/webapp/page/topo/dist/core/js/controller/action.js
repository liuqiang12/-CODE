define(["tool/winHandler","tool/brush","tool/rightMenu","tool/util","JTopo"],function(e,o,n,t){var i=!1;return{loadTopo:function(i,r){e.getTools().progress({now:10,text:"10%"}),e.init(i,r,r.prop.config.toolbar),e.setMode(r.prop.config.default_mode||"drag"),t.ajax({url:r.prop.config.rightMenu_url,type:"get",do:function(e){n.init(i,r,e),r.prop.config.urlMenu&&n.addUrlMenu(r.prop.config.urlMenu)}}),o[r.prop.config.brush].drawTopo({scene:r,fn:function(){r.prop.path.push(r.prop.pid)}})},addSceneListener:function(o){function n(e,n){e.ctrlKey?o.stage.wheelZoom||(n>0?o.stage.zoomOut():o.stage.zoomIn()):e.shiftKey?n>0?o.translateX+=200:o.translateX-=200:e.altKey||(n>0?o.translateY+=200:o.translateY-=200)}var r=function(e){i&&(e.preventDefault(),e=e||window.event,e.wheelDelta?(e.returnValue=!1,n(e,e.wheelDelta)):e.detail&&(e.returnValue=!1,n(e,e.detail)))};document.addEventListener&&document.addEventListener("DOMMouseScroll",r,!1),window.onmousewheel=document.onmousewheel=r,$(document).keydown(function(o){if(1==o.ctrlKey&&83==o.keyCode)return e.getToolBar().edit_save.click(),!1}),o.dbclick(function(e){var n=e.target;if(!n)return void console.info(this);if(console.info(n),n&&"container"==n.elementType)n.toggleExpand();else if(n&&"node"==n.elementType){if("node"==n.prop.nodeType)o.goDown(n.prop.id);else if("container"==n.prop.nodeType){var t=n.prop.expandTo;t.toggleExpand()}}else n&&"link"==n.elementType&&n.toggleExpend(o)}),o.mouseout(function(e){i=!1}),o.mousemove(function(o){i=!0;var n=o.target;if(n&&"node"==n.elementType){var r,p={name:n.prop.name,pid:n.prop.pid||"无"},a="",l=0;$.each(p,function(e,o){a+="<h5>&nbsp;&nbsp;"+e+":"+o+"</h5>",r=t.getStringWidth(e+":"+o)+20,r>l&&(l=r)}),e.getTools().tips({x:o.pageX+30,y:o.pageY+30,width:l,content:a})}else e.getTools().tips("hide")}),o.mouseup(function(n){if(0==n.button&&"edit"==this.prop.mode){var t=n.target;t&&"node"==t.elementType&&"container"!=t.prop.nodeType&&!t.prop.container&&$.each(o.findContainer(),function(o,n){if("container"==n.elementType&&n.isInside(t)&&n.prop.isExpand)return e.getTools().confirm({content:"是否加入分组?",handler:function(e){e&&(n.addNode(t),n.show())}}),!1})}}),o.mousedown(function(o){e.getTools().tips("hide")})}}});
//# sourceMappingURL=action.js.map